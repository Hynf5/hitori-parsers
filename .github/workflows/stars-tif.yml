name: â­ New Star Notification

on:
  watch:
    types: [started]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      # ===============================
      # ðŸ”Ž Get total stars
      # ===============================
      - name: Get total stars
        id: stars
        run: |
          STARS=$(curl -s \
            -H "Authorization: Bearer ${{ secrets.GITHUB_TOKEN }}" \
            https://api.github.com/repos/${{ github.repository }} \
            | jq '.stargazers_count')

          echo "count=$STARS" >> $GITHUB_OUTPUT

      # ===============================
      # â­ Send Discord Embed
      # ===============================
      - name: Send Discord Embed â­
        uses: tsickert/discord-webhook@v7.0.0
        with:
          webhook-url: ${{ secrets.DISCORD_WEBHOOK_URL }}

          embed-title: "â­ New Star Received!"
          embed-url: https://github.com/${{ github.repository }}

          embed-description: |
            > **ðŸ‘¤ User:** `${{ github.actor }}`
            > **ðŸ“¦ Repository:** `${{ github.repository }}`
            > **âœ¨ Total Stars:** **${{ steps.stars.outputs.count }}**

          embed-thumbnail-url: https://github.com/${{ github.actor }}.png
          embed-color: 16776960
          embed-footer-text: "GitHub Star Event"
          embed-footer-icon-url: https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png
